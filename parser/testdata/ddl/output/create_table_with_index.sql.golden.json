[
  {
    "CreatePos": 0,
    "StatementEnd": 1056,
    "OrReplace": false,
    "Name": {
      "Database": null,
      "Table": {
        "Name": "test_local",
        "QuoteType": 1,
        "NamePos": 27,
        "NameEnd": 37
      }
    },
    "IfNotExists": true,
    "UUID": null,
    "OnCluster": null,
    "TableSchema": {
      "SchemaPos": 39,
      "SchemaEnd": 614,
      "Columns": [
        {
          "NamePos": 44,
          "ColumnEnd": 76,
          "Name": {
            "Ident": {
              "Name": "common.id",
              "QuoteType": 3,
              "NamePos": 44,
              "NameEnd": 53
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "String",
              "QuoteType": 1,
              "NamePos": 55,
              "NameEnd": 61
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": {
            "CodecPos": 62,
            "RightParenPos": 76,
            "Type": null,
            "TypeLevel": null,
            "Name": {
              "Name": "ZSTD",
              "QuoteType": 1,
              "NamePos": 68,
              "NameEnd": 72
            },
            "Level": {
              "NumPos": 72,
              "NumEnd": 74,
              "Literal": "1",
              "Base": 10
            }
          },
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 81,
          "ColumnEnd": 113,
          "Name": {
            "Ident": {
              "Name": "id",
              "QuoteType": 3,
              "NamePos": 81,
              "NameEnd": 83
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "UInt64",
              "QuoteType": 1,
              "NamePos": 85,
              "NameEnd": 91
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": {
            "CodecPos": 92,
            "RightParenPos": 113,
            "Type": {
              "Name": "Delta",
              "QuoteType": 1,
              "NamePos": 98,
              "NameEnd": 103
            },
            "TypeLevel": null,
            "Name": {
              "Name": "ZSTD",
              "QuoteType": 1,
              "NamePos": 105,
              "NameEnd": 109
            },
            "Level": {
              "NumPos": 109,
              "NumEnd": 111,
              "Literal": "1",
              "Base": 10
            }
          },
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 118,
          "ColumnEnd": 147,
          "Name": {
            "Ident": {
              "Name": "api_id",
              "QuoteType": 3,
              "NamePos": 118,
              "NameEnd": 124
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "UInt64",
              "QuoteType": 1,
              "NamePos": 126,
              "NameEnd": 132
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": {
            "CodecPos": 133,
            "RightParenPos": 147,
            "Type": null,
            "TypeLevel": null,
            "Name": {
              "Name": "ZSTD",
              "QuoteType": 1,
              "NamePos": 139,
              "NameEnd": 143
            },
            "Level": {
              "NumPos": 143,
              "NumEnd": 145,
              "Literal": "1",
              "Base": 10
            }
          },
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 152,
          "ColumnEnd": 168,
          "Name": {
            "Ident": {
              "Name": "arr",
              "QuoteType": 3,
              "NamePos": 152,
              "NameEnd": 155
            },
            "DotIdent": null
          },
          "Type": {
            "LeftParenPos": 163,
            "RightParenPos": 168,
            "Name": {
              "Name": "Array",
              "QuoteType": 1,
              "NamePos": 157,
              "NameEnd": 162
            },
            "Params": [
              {
                "Name": {
                  "Name": "Int64",
                  "QuoteType": 1,
                  "NamePos": 163,
                  "NameEnd": 168
                }
              }
            ]
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 174,
          "ColumnEnd": 204,
          "Name": {
            "Ident": {
              "Name": "content",
              "QuoteType": 3,
              "NamePos": 174,
              "NameEnd": 181
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "String",
              "QuoteType": 1,
              "NamePos": 183,
              "NameEnd": 189
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": {
            "CodecPos": 190,
            "RightParenPos": 204,
            "Type": null,
            "TypeLevel": null,
            "Name": {
              "Name": "ZSTD",
              "QuoteType": 1,
              "NamePos": 196,
              "NameEnd": 200
            },
            "Level": {
              "NumPos": 200,
              "NumEnd": 202,
              "Literal": "1",
              "Base": 10
            }
          },
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 209,
          "ColumnEnd": 223,
          "Name": {
            "Ident": {
              "Name": "output",
              "QuoteType": 3,
              "NamePos": 209,
              "NameEnd": 215
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "String",
              "QuoteType": 1,
              "NamePos": 217,
              "NameEnd": 223
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "IndexPos": 227,
          "Name": {
            "Ident": {
              "Name": "id_common_id_bloom_filter",
              "QuoteType": 1,
              "NamePos": 233,
              "NameEnd": 258
            },
            "DotIdent": null
          },
          "ColumnExpr": {
            "Expr": {
              "Fields": [
                {
                  "Name": "common",
                  "QuoteType": 1,
                  "NamePos": 259,
                  "NameEnd": 265
                },
                {
                  "Name": "id",
                  "QuoteType": 1,
                  "NamePos": 266,
                  "NameEnd": 268
                }
              ]
            },
            "Alias": null
          },
          "ColumnType": {
            "LeftParenPos": 287,
            "RightParenPos": 292,
            "Name": {
              "Name": "bloom_filter",
              "QuoteType": 1,
              "NamePos": 274,
              "NameEnd": 286
            },
            "Params": [
              {
                "NumPos": 287,
                "NumEnd": 292,
                "Literal": "0.001",
                "Base": 10
              }
            ]
          },
          "Granularity": {
            "NumPos": 306,
            "NumEnd": 307,
            "Literal": "1",
            "Base": 10
          }
        },
        {
          "IndexPos": 311,
          "Name": {
            "Ident": {
              "Name": "id_idx",
              "QuoteType": 1,
              "NamePos": 317,
              "NameEnd": 323
            },
            "DotIdent": null
          },
          "ColumnExpr": {
            "Expr": {
              "Name": "id",
              "QuoteType": 1,
              "NamePos": 324,
              "NameEnd": 326
            },
            "Alias": null
          },
          "ColumnType": {
            "Name": {
              "Name": "minmax",
              "QuoteType": 1,
              "NamePos": 332,
              "NameEnd": 338
            }
          },
          "Granularity": {
            "NumPos": 351,
            "NumEnd": 353,
            "Literal": "10",
            "Base": 10
          }
        },
        {
          "IndexPos": 357,
          "Name": {
            "Ident": {
              "Name": "api_id_idx",
              "QuoteType": 1,
              "NamePos": 363,
              "NameEnd": 373
            },
            "DotIdent": null
          },
          "ColumnExpr": {
            "Expr": {
              "Name": "api_id",
              "QuoteType": 1,
              "NamePos": 374,
              "NameEnd": 380
            },
            "Alias": null
          },
          "ColumnType": {
            "LeftParenPos": 390,
            "RightParenPos": 393,
            "Name": {
              "Name": "set",
              "QuoteType": 1,
              "NamePos": 386,
              "NameEnd": 389
            },
            "Params": [
              {
                "NumPos": 390,
                "NumEnd": 393,
                "Literal": "100",
                "Base": 10
              }
            ]
          },
          "Granularity": {
            "NumPos": 407,
            "NumEnd": 408,
            "Literal": "2",
            "Base": 10
          }
        },
        {
          "IndexPos": 412,
          "Name": {
            "Ident": {
              "Name": "arr_idx",
              "QuoteType": 1,
              "NamePos": 418,
              "NameEnd": 425
            },
            "DotIdent": null
          },
          "ColumnExpr": {
            "Expr": {
              "Name": "arr",
              "QuoteType": 1,
              "NamePos": 426,
              "NameEnd": 429
            },
            "Alias": null
          },
          "ColumnType": {
            "LeftParenPos": 448,
            "RightParenPos": 452,
            "Name": {
              "Name": "bloom_filter",
              "QuoteType": 1,
              "NamePos": 435,
              "NameEnd": 447
            },
            "Params": [
              {
                "NumPos": 448,
                "NumEnd": 452,
                "Literal": "0.01",
                "Base": 10
              }
            ]
          },
          "Granularity": {
            "NumPos": 466,
            "NumEnd": 467,
            "Literal": "3",
            "Base": 10
          }
        },
        {
          "IndexPos": 471,
          "Name": {
            "Ident": {
              "Name": "content_idx",
              "QuoteType": 1,
              "NamePos": 477,
              "NameEnd": 488
            },
            "DotIdent": null
          },
          "ColumnExpr": {
            "Expr": {
              "Name": "content",
              "QuoteType": 1,
              "NamePos": 489,
              "NameEnd": 496
            },
            "Alias": null
          },
          "ColumnType": {
            "LeftParenPos": 513,
            "RightParenPos": 524,
            "Name": {
              "Name": "tokenbf_v1",
              "QuoteType": 1,
              "NamePos": 502,
              "NameEnd": 512
            },
            "Params": [
              {
                "NumPos": 513,
                "NumEnd": 518,
                "Literal": "30720",
                "Base": 10
              },
              {
                "NumPos": 520,
                "NumEnd": 521,
                "Literal": "2",
                "Base": 10
              },
              {
                "NumPos": 523,
                "NumEnd": 524,
                "Literal": "0",
                "Base": 10
              }
            ]
          },
          "Granularity": {
            "NumPos": 538,
            "NumEnd": 539,
            "Literal": "1",
            "Base": 10
          }
        },
        {
          "IndexPos": 543,
          "Name": {
            "Ident": {
              "Name": "output_idx",
              "QuoteType": 1,
              "NamePos": 549,
              "NameEnd": 559
            },
            "DotIdent": null
          },
          "ColumnExpr": {
            "Expr": {
              "Name": "output",
              "QuoteType": 1,
              "NamePos": 560,
              "NameEnd": 566
            },
            "Alias": null
          },
          "ColumnType": {
            "LeftParenPos": 583,
            "RightParenPos": 597,
            "Name": {
              "Name": "ngrambf_v1",
              "QuoteType": 1,
              "NamePos": 572,
              "NameEnd": 582
            },
            "Params": [
              {
                "NumPos": 583,
                "NumEnd": 584,
                "Literal": "3",
                "Base": 10
              },
              {
                "NumPos": 586,
                "NumEnd": 591,
                "Literal": "10000",
                "Base": 10
              },
              {
                "NumPos": 593,
                "NumEnd": 594,
                "Literal": "2",
                "Base": 10
              },
              {
                "NumPos": 596,
                "NumEnd": 597,
                "Literal": "1",
                "Base": 10
              }
            ]
          },
          "Granularity": {
            "NumPos": 611,
            "NumEnd": 612,
            "Literal": "2",
            "Base": 10
          }
        }
      ],
      "AliasTable": null,
      "TableFunction": null
    },
    "Engine": {
      "EnginePos": 617,
      "EngineEnd": 1056,
      "Name": "ReplicatedMergeTree",
      "Params": {
        "LeftParenPos": 645,
        "RightParenPos": 677,
        "Items": {
          "ListPos": 647,
          "ListEnd": 676,
          "HasDistinct": false,
          "Items": [
            {
              "Expr": {
                "LiteralPos": 647,
                "LiteralEnd": 663,
                "Literal": "/root/test_local"
              },
              "Alias": null
            },
            {
              "Expr": {
                "LiteralPos": 667,
                "LiteralEnd": 676,
                "Literal": "{replica}"
              },
              "Alias": null
            }
          ]
        },
        "ColumnArgList": null
      },
      "PrimaryKey": null,
      "PartitionBy": {
        "PartitionPos": 680,
        "Expr": {
          "ListPos": 693,
          "ListEnd": 718,
          "HasDistinct": false,
          "Items": [
            {
              "Expr": {
                "Name": {
                  "Name": "toStartOfHour",
                  "QuoteType": 1,
                  "NamePos": 693,
                  "NameEnd": 706
                },
                "Params": {
                  "LeftParenPos": 706,
                  "RightParenPos": 718,
                  "Items": {
                    "ListPos": 708,
                    "ListEnd": 717,
                    "HasDistinct": false,
                    "Items": [
                      {
                        "Expr": {
                          "Name": "timestamp",
                          "QuoteType": 3,
                          "NamePos": 708,
                          "NameEnd": 717
                        },
                        "Alias": null
                      }
                    ]
                  },
                  "ColumnArgList": null
                }
              },
              "Alias": null
            }
          ]
        }
      },
      "SampleBy": null,
      "TTL": {
        "TTLPos": 778,
        "ListEnd": 869,
        "Items": [
          {
            "TTLPos": 778,
            "Expr": {
              "LeftExpr": {
                "Name": {
                  "Name": "toStartOfHour",
                  "QuoteType": 1,
                  "NamePos": 782,
                  "NameEnd": 795
                },
                "Params": {
                  "LeftParenPos": 795,
                  "RightParenPos": 807,
                  "Items": {
                    "ListPos": 797,
                    "ListEnd": 806,
                    "HasDistinct": false,
                    "Items": [
                      {
                        "Expr": {
                          "Name": "timestamp",
                          "QuoteType": 3,
                          "NamePos": 797,
                          "NameEnd": 806
                        },
                        "Alias": null
                      }
                    ]
                  },
                  "ColumnArgList": null
                }
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 811,
                "Expr": {
                  "NumPos": 820,
                  "NumEnd": 821,
                  "Literal": "7",
                  "Base": 10
                },
                "Unit": {
                  "Name": "DAY",
                  "QuoteType": 1,
                  "NamePos": 822,
                  "NameEnd": 825
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": null
          },
          {
            "TTLPos": 778,
            "Expr": {
              "LeftExpr": {
                "Name": {
                  "Name": "toStartOfHour",
                  "QuoteType": 1,
                  "NamePos": 826,
                  "NameEnd": 839
                },
                "Params": {
                  "LeftParenPos": 839,
                  "RightParenPos": 851,
                  "Items": {
                    "ListPos": 841,
                    "ListEnd": 850,
                    "HasDistinct": false,
                    "Items": [
                      {
                        "Expr": {
                          "Name": "timestamp",
                          "QuoteType": 3,
                          "NamePos": 841,
                          "NameEnd": 850
                        },
                        "Alias": null
                      }
                    ]
                  },
                  "ColumnArgList": null
                }
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 855,
                "Expr": {
                  "NumPos": 864,
                  "NumEnd": 865,
                  "Literal": "2",
                  "Base": 10
                },
                "Unit": {
                  "Name": "DAY",
                  "QuoteType": 1,
                  "NamePos": 866,
                  "NameEnd": 869
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": null
          }
        ]
      },
      "Settings": {
        "SettingsPos": 871,
        "ListEnd": 1056,
        "Items": [
          {
            "SettingsPos": 880,
            "Name": {
              "Name": "execute_merges_on_single_replica_time_threshold",
              "QuoteType": 1,
              "NamePos": 880,
              "NameEnd": 927
            },
            "Expr": {
              "NumPos": 928,
              "NumEnd": 932,
              "Literal": "1200",
              "Base": 10
            }
          },
          {
            "SettingsPos": 934,
            "Name": {
              "Name": "index_granularity",
              "QuoteType": 1,
              "NamePos": 934,
              "NameEnd": 951
            },
            "Expr": {
              "NumPos": 952,
              "NumEnd": 957,
              "Literal": "16384",
              "Base": 10
            }
          },
          {
            "SettingsPos": 959,
            "Name": {
              "Name": "max_bytes_to_merge_at_max_space_in_pool",
              "QuoteType": 1,
              "NamePos": 959,
              "NameEnd": 998
            },
            "Expr": {
              "NumPos": 999,
              "NumEnd": 1010,
              "Literal": "64424509440",
              "Base": 10
            }
          },
          {
            "SettingsPos": 1012,
            "Name": {
              "Name": "storage_policy",
              "QuoteType": 1,
              "NamePos": 1012,
              "NameEnd": 1026
            },
            "Expr": {
              "LiteralPos": 1028,
              "LiteralEnd": 1032,
              "Literal": "main"
            }
          },
          {
            "SettingsPos": 1035,
            "Name": {
              "Name": "ttl_only_drop_parts",
              "QuoteType": 1,
              "NamePos": 1035,
              "NameEnd": 1054
            },
            "Expr": {
              "NumPos": 1055,
              "NumEnd": 1056,
              "Literal": "1",
              "Base": 10
            }
          }
        ]
      },
      "OrderBy": {
        "OrderPos": 721,
        "ListEnd": 775,
        "Items": [
          {
            "OrderPos": 721,
            "Expr": {
              "LeftParenPos": 730,
              "RightParenPos": 775,
              "Items": {
                "ListPos": 731,
                "ListEnd": 774,
                "HasDistinct": false,
                "Items": [
                  {
                    "Expr": {
                      "Name": {
                        "Name": "toUnixTimestamp64Nano",
                        "QuoteType": 1,
                        "NamePos": 731,
                        "NameEnd": 752
                      },
                      "Params": {
                        "LeftParenPos": 752,
                        "RightParenPos": 764,
                        "Items": {
                          "ListPos": 754,
                          "ListEnd": 763,
                          "HasDistinct": false,
                          "Items": [
                            {
                              "Expr": {
                                "Name": "timestamp",
                                "QuoteType": 3,
                                "NamePos": 754,
                                "NameEnd": 763
                              },
                              "Alias": null
                            }
                          ]
                        },
                        "ColumnArgList": null
                      }
                    },
                    "Alias": null
                  },
                  {
                    "Expr": {
                      "Name": "api_id",
                      "QuoteType": 3,
                      "NamePos": 768,
                      "NameEnd": 774
                    },
                    "Alias": null
                  }
                ]
              },
              "ColumnArgList": null
            },
            "Alias": null,
            "Direction": ""
          }
        ]
      }
    },
    "SubQuery": null,
    "HasTemporary": false,
    "Comment": null
  }
]