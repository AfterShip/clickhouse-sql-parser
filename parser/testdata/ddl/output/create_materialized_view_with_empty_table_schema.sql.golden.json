[
  {
    "CreatePos": 0,
    "StatementEnd": 474,
    "Name": {
      "Database": {
        "Name": "test",
        "QuoteType": 1,
        "NamePos": 25,
        "NameEnd": 29
      },
      "Table": {
        "Name": "t0",
        "QuoteType": 1,
        "NamePos": 30,
        "NameEnd": 32
      }
    },
    "IfNotExists": false,
    "OnCluster": {
      "OnPos": 33,
      "Expr": {
        "Name": "default_cluster",
        "QuoteType": 1,
        "NamePos": 44,
        "NameEnd": 59
      }
    },
    "Refresh": null,
    "RandomizeFor": null,
    "DependsOn": null,
    "Settings": null,
    "HasAppend": false,
    "Engine": {
      "EnginePos": 61,
      "EngineEnd": 193,
      "Name": "ReplicatedAggregatingMergeTree",
      "Params": {
        "LeftParenPos": 100,
        "RightParenPos": 151,
        "Items": {
          "ListPos": 102,
          "ListEnd": 150,
          "HasDistinct": false,
          "Items": [
            {
              "Expr": {
                "LiteralPos": 102,
                "LiteralEnd": 137,
                "Literal": "/clickhouse/{layer}-{shard}/test/t0"
              },
              "Alias": null
            },
            {
              "Expr": {
                "LiteralPos": 141,
                "LiteralEnd": 150,
                "Literal": "{replica}"
              },
              "Alias": null
            }
          ]
        },
        "ColumnArgList": null
      },
      "PrimaryKey": null,
      "PartitionBy": {
        "PartitionPos": 154,
        "Expr": {
          "ListPos": 167,
          "ListEnd": 178,
          "HasDistinct": false,
          "Items": [
            {
              "Expr": {
                "Name": {
                  "Name": "toYYYYMM",
                  "QuoteType": 1,
                  "NamePos": 167,
                  "NameEnd": 175
                },
                "Params": {
                  "LeftParenPos": 175,
                  "RightParenPos": 178,
                  "Items": {
                    "ListPos": 176,
                    "ListEnd": 178,
                    "HasDistinct": false,
                    "Items": [
                      {
                        "Expr": {
                          "Name": "f0",
                          "QuoteType": 1,
                          "NamePos": 176,
                          "NameEnd": 178
                        },
                        "Alias": null
                      }
                    ]
                  },
                  "ColumnArgList": null
                }
              },
              "Alias": null
            }
          ]
        }
      },
      "SampleBy": null,
      "TTL": null,
      "Settings": null,
      "OrderBy": {
        "OrderPos": 181,
        "ListEnd": 193,
        "Items": [
          {
            "OrderPos": 181,
            "Expr": {
              "LeftParenPos": 190,
              "RightParenPos": 193,
              "Items": {
                "ListPos": 191,
                "ListEnd": 193,
                "HasDistinct": false,
                "Items": [
                  {
                    "Expr": {
                      "Name": "f0",
                      "QuoteType": 1,
                      "NamePos": 191,
                      "NameEnd": 193
                    },
                    "Alias": null
                  }
                ]
              },
              "ColumnArgList": null
            },
            "Alias": null,
            "Direction": ""
          }
        ]
      }
    },
    "HasEmpty": false,
    "Destination": null,
    "SubQuery": {
      "HasParen": false,
      "Select": {
        "SelectPos": 209,
        "StatementEnd": 474,
        "With": null,
        "Top": null,
        "HasDistinct": false,
        "DistinctOn": null,
        "SelectItems": [
          {
            "Expr": {
              "Name": "f0",
              "QuoteType": 1,
              "NamePos": 216,
              "NameEnd": 218
            },
            "Modifiers": [],
            "Alias": null
          },
          {
            "Expr": {
              "Name": "f1",
              "QuoteType": 1,
              "NamePos": 219,
              "NameEnd": 221
            },
            "Modifiers": [],
            "Alias": null
          },
          {
            "Expr": {
              "Name": "f2",
              "QuoteType": 1,
              "NamePos": 222,
              "NameEnd": 224
            },
            "Modifiers": [],
            "Alias": null
          },
          {
            "Expr": {
              "Name": {
                "Name": "coalesce",
                "QuoteType": 1,
                "NamePos": 225,
                "NameEnd": 233
              },
              "Params": {
                "LeftParenPos": 233,
                "RightParenPos": 239,
                "Items": {
                  "ListPos": 234,
                  "ListEnd": 239,
                  "HasDistinct": false,
                  "Items": [
                    {
                      "Expr": {
                        "Name": "f0",
                        "QuoteType": 1,
                        "NamePos": 234,
                        "NameEnd": 236
                      },
                      "Alias": null
                    },
                    {
                      "Expr": {
                        "Name": "f1",
                        "QuoteType": 1,
                        "NamePos": 237,
                        "NameEnd": 239
                      },
                      "Alias": null
                    }
                  ]
                },
                "ColumnArgList": null
              }
            },
            "Modifiers": [],
            "Alias": {
              "Name": "f333",
              "QuoteType": 1,
              "NamePos": 244,
              "NameEnd": 248
            }
          }
        ],
        "From": {
          "FromPos": 250,
          "Expr": {
            "Table": {
              "TablePos": 260,
              "TableEnd": 460,
              "Alias": null,
              "Expr": {
                "Expr": {
                  "HasParen": true,
                  "Select": {
                    "SelectPos": 261,
                    "StatementEnd": 445,
                    "With": null,
                    "Top": null,
                    "HasDistinct": false,
                    "DistinctOn": null,
                    "SelectItems": [
                      {
                        "Expr": {
                          "Name": "f0",
                          "QuoteType": 1,
                          "NamePos": 278,
                          "NameEnd": 280
                        },
                        "Modifiers": [],
                        "Alias": null
                      },
                      {
                        "Expr": {
                          "Name": "f1",
                          "QuoteType": 1,
                          "NamePos": 281,
                          "NameEnd": 283
                        },
                        "Modifiers": [],
                        "Alias": null
                      },
                      {
                        "Expr": {
                          "Name": "f2",
                          "QuoteType": 1,
                          "NamePos": 284,
                          "NameEnd": 286
                        },
                        "Modifiers": [],
                        "Alias": null
                      },
                      {
                        "Expr": {
                          "Function": {
                            "Name": {
                              "Name": "ROW_NUMBER",
                              "QuoteType": 1,
                              "NamePos": 298,
                              "NameEnd": 308
                            },
                            "Params": {
                              "LeftParenPos": 308,
                              "RightParenPos": 309,
                              "Items": {
                                "ListPos": 309,
                                "ListEnd": 309,
                                "HasDistinct": false,
                                "Items": []
                              },
                              "ColumnArgList": null
                            }
                          },
                          "OverPos": 311,
                          "OverExpr": {
                            "LeftParenPos": 315,
                            "RightParenPos": 356,
                            "PartitionBy": {
                              "PartitionPos": 315,
                              "Expr": {
                                "ListPos": 329,
                                "ListEnd": 331,
                                "HasDistinct": false,
                                "Items": [
                                  {
                                    "Expr": {
                                      "Name": "f0",
                                      "QuoteType": 1,
                                      "NamePos": 329,
                                      "NameEnd": 331
                                    },
                                    "Alias": null
                                  }
                                ]
                              }
                            },
                            "OrderBy": {
                              "OrderPos": 332,
                              "ListEnd": 355,
                              "Items": [
                                {
                                  "OrderPos": 332,
                                  "Expr": {
                                    "Name": {
                                      "Name": "coalesce",
                                      "QuoteType": 1,
                                      "NamePos": 341,
                                      "NameEnd": 349
                                    },
                                    "Params": {
                                      "LeftParenPos": 349,
                                      "RightParenPos": 355,
                                      "Items": {
                                        "ListPos": 350,
                                        "ListEnd": 355,
                                        "HasDistinct": false,
                                        "Items": [
                                          {
                                            "Expr": {
                                              "Name": "f1",
                                              "QuoteType": 1,
                                              "NamePos": 350,
                                              "NameEnd": 352
                                            },
                                            "Alias": null
                                          },
                                          {
                                            "Expr": {
                                              "Name": "f2",
                                              "QuoteType": 1,
                                              "NamePos": 353,
                                              "NameEnd": 355
                                            },
                                            "Alias": null
                                          }
                                        ]
                                      },
                                      "ColumnArgList": null
                                    }
                                  },
                                  "Alias": null,
                                  "Direction": ""
                                }
                              ]
                            },
                            "Frame": null
                          }
                        },
                        "Modifiers": [],
                        "Alias": {
                          "Name": "rn",
                          "QuoteType": 1,
                          "NamePos": 361,
                          "NameEnd": 363
                        }
                      }
                    ],
                    "From": {
                      "FromPos": 370,
                      "Expr": {
                        "Table": {
                          "TablePos": 375,
                          "TableEnd": 381,
                          "Alias": null,
                          "Expr": {
                            "Database": {
                              "Name": "test",
                              "QuoteType": 1,
                              "NamePos": 375,
                              "NameEnd": 379
                            },
                            "Table": {
                              "Name": "t",
                              "QuoteType": 1,
                              "NamePos": 380,
                              "NameEnd": 381
                            }
                          },
                          "HasFinal": false
                        },
                        "StatementEnd": 381,
                        "SampleRatio": null,
                        "HasFinal": false
                      }
                    },
                    "ArrayJoin": null,
                    "Window": null,
                    "Prewhere": null,
                    "Where": {
                      "WherePos": 388,
                      "Expr": {
                        "LeftExpr": {
                          "LeftExpr": {
                            "Name": "f3",
                            "QuoteType": 1,
                            "NamePos": 394,
                            "NameEnd": 396
                          },
                          "Operation": "IN",
                          "RightExpr": {
                            "LeftParenPos": 400,
                            "RightParenPos": 421,
                            "Items": {
                              "ListPos": 402,
                              "ListEnd": 420,
                              "HasDistinct": false,
                              "Items": [
                                {
                                  "Expr": {
                                    "LiteralPos": 402,
                                    "LiteralEnd": 405,
                                    "Literal": "foo"
                                  },
                                  "Alias": null
                                },
                                {
                                  "Expr": {
                                    "LiteralPos": 409,
                                    "LiteralEnd": 412,
                                    "Literal": "bar"
                                  },
                                  "Alias": null
                                },
                                {
                                  "Expr": {
                                    "LiteralPos": 416,
                                    "LiteralEnd": 420,
                                    "Literal": "test"
                                  },
                                  "Alias": null
                                }
                              ]
                            },
                            "ColumnArgList": null
                          },
                          "HasGlobal": false,
                          "HasNot": false
                        },
                        "Operation": "AND",
                        "RightExpr": {
                          "LeftExpr": {
                            "Name": "env",
                            "QuoteType": 1,
                            "NamePos": 435,
                            "NameEnd": 438
                          },
                          "Operation": "=",
                          "RightExpr": {
                            "LiteralPos": 441,
                            "LiteralEnd": 445,
                            "Literal": "test"
                          },
                          "HasGlobal": false,
                          "HasNot": false
                        },
                        "HasGlobal": false,
                        "HasNot": false
                      }
                    },
                    "GroupBy": null,
                    "WithTotal": false,
                    "Having": null,
                    "OrderBy": null,
                    "LimitBy": null,
                    "Limit": null,
                    "Settings": null,
                    "Format": null,
                    "UnionAll": null,
                    "UnionDistinct": null,
                    "Except": null
                  }
                },
                "AliasPos": 457,
                "Alias": {
                  "Name": "tmp",
                  "QuoteType": 1,
                  "NamePos": 457,
                  "NameEnd": 460
                }
              },
              "HasFinal": false
            },
            "StatementEnd": 460,
            "SampleRatio": null,
            "HasFinal": false
          }
        },
        "ArrayJoin": null,
        "Window": null,
        "Prewhere": null,
        "Where": {
          "WherePos": 462,
          "Expr": {
            "LeftExpr": {
              "Name": "rn",
              "QuoteType": 1,
              "NamePos": 468,
              "NameEnd": 470
            },
            "Operation": "=",
            "RightExpr": {
              "NumPos": 473,
              "NumEnd": 474,
              "Literal": "1",
              "Base": 10
            },
            "HasGlobal": false,
            "HasNot": false
          }
        },
        "GroupBy": null,
        "WithTotal": false,
        "Having": null,
        "OrderBy": null,
        "LimitBy": null,
        "Limit": null,
        "Settings": null,
        "Format": null,
        "UnionAll": null,
        "UnionDistinct": null,
        "Except": null
      }
    },
    "Populate": true,
    "Comment": null,
    "Definer": null,
    "SQLSecurity": ""
  }
]