[
  {
    "CreatePos": 0,
    "StatementEnd": 213,
    "OrReplace": false,
    "Name": {
      "Database": null,
      "Table": {
        "Name": "tab",
        "QuoteType": 1,
        "NamePos": 13,
        "NameEnd": 16
      }
    },
    "IfNotExists": false,
    "UUID": null,
    "OnCluster": null,
    "TableSchema": {
      "SchemaPos": 18,
      "SchemaEnd": 49,
      "Columns": [
        {
          "NamePos": 25,
          "ColumnEnd": 35,
          "Name": {
            "Ident": {
              "Name": "d",
              "QuoteType": 1,
              "NamePos": 25,
              "NameEnd": 26
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "DateTime",
              "QuoteType": 1,
              "NamePos": 27,
              "NameEnd": 35
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 42,
          "ColumnEnd": 47,
          "Name": {
            "Ident": {
              "Name": "a",
              "QuoteType": 1,
              "NamePos": 42,
              "NameEnd": 43
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "Int",
              "QuoteType": 1,
              "NamePos": 44,
              "NameEnd": 47
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        }
      ],
      "AliasTable": null,
      "TableFunction": null
    },
    "Engine": {
      "EnginePos": 56,
      "EngineEnd": 213,
      "Name": "MergeTree",
      "Params": null,
      "PrimaryKey": null,
      "PartitionBy": {
        "PartitionPos": 76,
        "Expr": {
          "ListPos": 89,
          "ListEnd": 99,
          "HasDistinct": false,
          "Items": [
            {
              "Expr": {
                "Name": {
                  "Name": "toYYYYMM",
                  "QuoteType": 1,
                  "NamePos": 89,
                  "NameEnd": 97
                },
                "Params": {
                  "LeftParenPos": 97,
                  "RightParenPos": 99,
                  "Items": {
                    "ListPos": 98,
                    "ListEnd": 99,
                    "HasDistinct": false,
                    "Items": [
                      {
                        "Expr": {
                          "Name": "d",
                          "QuoteType": 1,
                          "NamePos": 98,
                          "NameEnd": 99
                        },
                        "Alias": null
                      }
                    ]
                  },
                  "ColumnArgList": null
                }
              },
              "Alias": null
            }
          ]
        }
      },
      "SampleBy": null,
      "TTL": {
        "TTLPos": 114,
        "ListEnd": 213,
        "Items": [
          {
            "TTLPos": 114,
            "Expr": {
              "LeftExpr": {
                "Name": "d",
                "QuoteType": 1,
                "NamePos": 118,
                "NameEnd": 119
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 122,
                "Expr": {
                  "NumPos": 131,
                  "NumEnd": 132,
                  "Literal": "1",
                  "Base": 10
                },
                "Unit": {
                  "Name": "MONTH",
                  "QuoteType": 1,
                  "NamePos": 133,
                  "NameEnd": 138
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": {
              "Item": {
                "RulePos": 139,
                "ToVolume": null,
                "ToDisk": null,
                "Action": {
                  "ActionPos": 139,
                  "ActionEnd": 145,
                  "Action": "DELETE",
                  "Codec": null
                }
              },
              "Where": null,
              "GroupBy": null
            }
          },
          {
            "TTLPos": 114,
            "Expr": {
              "LeftExpr": {
                "Name": "d",
                "QuoteType": 1,
                "NamePos": 152,
                "NameEnd": 153
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 156,
                "Expr": {
                  "NumPos": 165,
                  "NumEnd": 166,
                  "Literal": "1",
                  "Base": 10
                },
                "Unit": {
                  "Name": "WEEK",
                  "QuoteType": 1,
                  "NamePos": 167,
                  "NameEnd": 171
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": {
              "Item": {
                "RulePos": 172,
                "ToVolume": {
                  "LiteralPos": 183,
                  "LiteralEnd": 186,
                  "Literal": "aaa"
                },
                "ToDisk": null,
                "Action": null
              },
              "Where": null,
              "GroupBy": null
            }
          },
          {
            "TTLPos": 114,
            "Expr": {
              "LeftExpr": {
                "Name": "d",
                "QuoteType": 1,
                "NamePos": 194,
                "NameEnd": 195
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 198,
                "Expr": {
                  "NumPos": 207,
                  "NumEnd": 208,
                  "Literal": "2",
                  "Base": 10
                },
                "Unit": {
                  "Name": "WEEK",
                  "QuoteType": 1,
                  "NamePos": 209,
                  "NameEnd": 213
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": {
              "Item": {
                "RulePos": 214,
                "ToVolume": null,
                "ToDisk": {
                  "LiteralPos": 223,
                  "LiteralEnd": 226,
                  "Literal": "bbb"
                },
                "Action": null
              },
              "Where": null,
              "GroupBy": null
            }
          }
        ]
      },
      "Settings": null,
      "OrderBy": {
        "OrderPos": 102,
        "ListEnd": 112,
        "Items": [
          {
            "OrderPos": 102,
            "Expr": {
              "Name": "d",
              "QuoteType": 1,
              "NamePos": 111,
              "NameEnd": 112
            },
            "Alias": null,
            "Direction": ""
          }
        ]
      }
    },
    "SubQuery": null,
    "HasTemporary": false,
    "Comment": null
  },
  {
    "CreatePos": 234,
    "StatementEnd": 385,
    "OrReplace": false,
    "Name": {
      "Database": null,
      "Table": {
        "Name": "table_with_where",
        "QuoteType": 1,
        "NamePos": 247,
        "NameEnd": 263
      }
    },
    "IfNotExists": false,
    "UUID": null,
    "OnCluster": null,
    "TableSchema": {
      "SchemaPos": 265,
      "SchemaEnd": 296,
      "Columns": [
        {
          "NamePos": 272,
          "ColumnEnd": 282,
          "Name": {
            "Ident": {
              "Name": "d",
              "QuoteType": 1,
              "NamePos": 272,
              "NameEnd": 273
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "DateTime",
              "QuoteType": 1,
              "NamePos": 274,
              "NameEnd": 282
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 289,
          "ColumnEnd": 294,
          "Name": {
            "Ident": {
              "Name": "a",
              "QuoteType": 1,
              "NamePos": 289,
              "NameEnd": 290
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "Int",
              "QuoteType": 1,
              "NamePos": 291,
              "NameEnd": 294
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        }
      ],
      "AliasTable": null,
      "TableFunction": null
    },
    "Engine": {
      "EnginePos": 303,
      "EngineEnd": 385,
      "Name": "MergeTree",
      "Params": null,
      "PrimaryKey": null,
      "PartitionBy": {
        "PartitionPos": 323,
        "Expr": {
          "ListPos": 336,
          "ListEnd": 346,
          "HasDistinct": false,
          "Items": [
            {
              "Expr": {
                "Name": {
                  "Name": "toYYYYMM",
                  "QuoteType": 1,
                  "NamePos": 336,
                  "NameEnd": 344
                },
                "Params": {
                  "LeftParenPos": 344,
                  "RightParenPos": 346,
                  "Items": {
                    "ListPos": 345,
                    "ListEnd": 346,
                    "HasDistinct": false,
                    "Items": [
                      {
                        "Expr": {
                          "Name": "d",
                          "QuoteType": 1,
                          "NamePos": 345,
                          "NameEnd": 346
                        },
                        "Alias": null
                      }
                    ]
                  },
                  "ColumnArgList": null
                }
              },
              "Alias": null
            }
          ]
        }
      },
      "SampleBy": null,
      "TTL": {
        "TTLPos": 361,
        "ListEnd": 385,
        "Items": [
          {
            "TTLPos": 361,
            "Expr": {
              "LeftExpr": {
                "Name": "d",
                "QuoteType": 1,
                "NamePos": 365,
                "NameEnd": 366
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 369,
                "Expr": {
                  "NumPos": 378,
                  "NumEnd": 379,
                  "Literal": "1",
                  "Base": 10
                },
                "Unit": {
                  "Name": "MONTH",
                  "QuoteType": 1,
                  "NamePos": 380,
                  "NameEnd": 385
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": {
              "Item": {
                "RulePos": 386,
                "ToVolume": null,
                "ToDisk": null,
                "Action": {
                  "ActionPos": 386,
                  "ActionEnd": 392,
                  "Action": "DELETE",
                  "Codec": null
                }
              },
              "Where": {
                "WherePos": 393,
                "Expr": {
                  "LeftExpr": {
                    "Name": {
                      "Name": "toDayOfWeek",
                      "QuoteType": 1,
                      "NamePos": 399,
                      "NameEnd": 410
                    },
                    "Params": {
                      "LeftParenPos": 410,
                      "RightParenPos": 412,
                      "Items": {
                        "ListPos": 411,
                        "ListEnd": 412,
                        "HasDistinct": false,
                        "Items": [
                          {
                            "Expr": {
                              "Name": "d",
                              "QuoteType": 1,
                              "NamePos": 411,
                              "NameEnd": 412
                            },
                            "Alias": null
                          }
                        ]
                      },
                      "ColumnArgList": null
                    }
                  },
                  "Operation": "=",
                  "RightExpr": {
                    "NumPos": 416,
                    "NumEnd": 417,
                    "Literal": "1",
                    "Base": 10
                  },
                  "HasGlobal": false,
                  "HasNot": false
                }
              },
              "GroupBy": null
            }
          }
        ]
      },
      "Settings": null,
      "OrderBy": {
        "OrderPos": 349,
        "ListEnd": 359,
        "Items": [
          {
            "OrderPos": 349,
            "Expr": {
              "Name": "d",
              "QuoteType": 1,
              "NamePos": 358,
              "NameEnd": 359
            },
            "Alias": null,
            "Direction": ""
          }
        ]
      }
    },
    "SubQuery": null,
    "HasTemporary": false,
    "Comment": null
  },
  {
    "CreatePos": 422,
    "StatementEnd": 739,
    "OrReplace": false,
    "Name": {
      "Database": null,
      "Table": {
        "Name": "table_for_recompression",
        "QuoteType": 1,
        "NamePos": 435,
        "NameEnd": 458
      }
    },
    "IfNotExists": false,
    "UUID": null,
    "OnCluster": null,
    "TableSchema": {
      "SchemaPos": 460,
      "SchemaEnd": 515,
      "Columns": [
        {
          "NamePos": 467,
          "ColumnEnd": 477,
          "Name": {
            "Ident": {
              "Name": "d",
              "QuoteType": 1,
              "NamePos": 467,
              "NameEnd": 468
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "DateTime",
              "QuoteType": 1,
              "NamePos": 469,
              "NameEnd": 477
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 484,
          "ColumnEnd": 494,
          "Name": {
            "Ident": {
              "Name": "key",
              "QuoteType": 1,
              "NamePos": 484,
              "NameEnd": 487
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "UInt64",
              "QuoteType": 1,
              "NamePos": 488,
              "NameEnd": 494
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        },
        {
          "NamePos": 501,
          "ColumnEnd": 513,
          "Name": {
            "Ident": {
              "Name": "value",
              "QuoteType": 1,
              "NamePos": 501,
              "NameEnd": 506
            },
            "DotIdent": null
          },
          "Type": {
            "Name": {
              "Name": "String",
              "QuoteType": 1,
              "NamePos": 507,
              "NameEnd": 513
            }
          },
          "NotNull": null,
          "Nullable": null,
          "DefaultExpr": null,
          "MaterializedExpr": null,
          "AliasExpr": null,
          "Codec": null,
          "TTL": null,
          "Comment": null,
          "CompressionCodec": null
        }
      ],
      "AliasTable": null,
      "TableFunction": null
    },
    "Engine": {
      "EnginePos": 517,
      "EngineEnd": 739,
      "Name": "MergeTree",
      "Params": {
        "LeftParenPos": 533,
        "RightParenPos": 534,
        "Items": {
          "ListPos": 534,
          "ListEnd": 534,
          "HasDistinct": false,
          "Items": []
        },
        "ColumnArgList": null
      },
      "PrimaryKey": null,
      "PartitionBy": {
        "PartitionPos": 555,
        "Expr": {
          "ListPos": 568,
          "ListEnd": 571,
          "HasDistinct": false,
          "Items": [
            {
              "Expr": {
                "Name": "key",
                "QuoteType": 1,
                "NamePos": 568,
                "NameEnd": 571
              },
              "Alias": null
            }
          ]
        }
      },
      "SampleBy": null,
      "TTL": {
        "TTLPos": 573,
        "ListEnd": 645,
        "Items": [
          {
            "TTLPos": 573,
            "Expr": {
              "LeftExpr": {
                "Name": "d",
                "QuoteType": 1,
                "NamePos": 577,
                "NameEnd": 578
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 581,
                "Expr": {
                  "NumPos": 590,
                  "NumEnd": 591,
                  "Literal": "1",
                  "Base": 10
                },
                "Unit": {
                  "Name": "MONTH",
                  "QuoteType": 1,
                  "NamePos": 592,
                  "NameEnd": 597
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": {
              "Item": {
                "RulePos": 598,
                "ToVolume": null,
                "ToDisk": null,
                "Action": {
                  "ActionPos": 598,
                  "ActionEnd": 608,
                  "Action": "RECOMPRESS",
                  "Codec": {
                    "CodecPos": 609,
                    "RightParenPos": 624,
                    "Type": null,
                    "TypeLevel": null,
                    "Name": {
                      "Name": "ZSTD",
                      "QuoteType": 1,
                      "NamePos": 615,
                      "NameEnd": 619
                    },
                    "Level": {
                      "NumPos": 619,
                      "NumEnd": 622,
                      "Literal": "17",
                      "Base": 10
                    }
                  }
                }
              },
              "Where": null,
              "GroupBy": null
            }
          },
          {
            "TTLPos": 573,
            "Expr": {
              "LeftExpr": {
                "Name": "d",
                "QuoteType": 1,
                "NamePos": 626,
                "NameEnd": 627
              },
              "Operation": "+",
              "RightExpr": {
                "IntervalPos": 630,
                "Expr": {
                  "NumPos": 639,
                  "NumEnd": 640,
                  "Literal": "1",
                  "Base": 10
                },
                "Unit": {
                  "Name": "YEAR",
                  "QuoteType": 1,
                  "NamePos": 641,
                  "NameEnd": 645
                }
              },
              "HasGlobal": false,
              "HasNot": false
            },
            "Policy": {
              "Item": {
                "RulePos": 646,
                "ToVolume": null,
                "ToDisk": null,
                "Action": {
                  "ActionPos": 646,
                  "ActionEnd": 656,
                  "Action": "RECOMPRESS",
                  "Codec": {
                    "CodecPos": 657,
                    "RightParenPos": 673,
                    "Type": null,
                    "TypeLevel": null,
                    "Name": {
                      "Name": "LZ4HC",
                      "QuoteType": 1,
                      "NamePos": 663,
                      "NameEnd": 668
                    },
                    "Level": {
                      "NumPos": 668,
                      "NumEnd": 671,
                      "Literal": "10",
                      "Base": 10
                    }
                  }
                }
              },
              "Where": null,
              "GroupBy": null
            }
          }
        ]
      },
      "Settings": {
        "SettingsPos": 675,
        "ListEnd": 739,
        "Items": [
          {
            "SettingsPos": 684,
            "Name": {
              "Name": "min_rows_for_wide_part",
              "QuoteType": 1,
              "NamePos": 684,
              "NameEnd": 706
            },
            "Expr": {
              "NumPos": 709,
              "NumEnd": 710,
              "Literal": "0",
              "Base": 10
            }
          },
          {
            "SettingsPos": 712,
            "Name": {
              "Name": "min_bytes_for_wide_part",
              "QuoteType": 1,
              "NamePos": 712,
              "NameEnd": 735
            },
            "Expr": {
              "NumPos": 738,
              "NumEnd": 739,
              "Literal": "0",
              "Base": 10
            }
          }
        ]
      },
      "OrderBy": {
        "OrderPos": 537,
        "ListEnd": 552,
        "Items": [
          {
            "OrderPos": 537,
            "Expr": {
              "Name": {
                "Name": "tuple",
                "QuoteType": 1,
                "NamePos": 546,
                "NameEnd": 551
              },
              "Params": {
                "LeftParenPos": 551,
                "RightParenPos": 552,
                "Items": {
                  "ListPos": 552,
                  "ListEnd": 552,
                  "HasDistinct": false,
                  "Items": []
                },
                "ColumnArgList": null
              }
            },
            "Alias": null,
            "Direction": ""
          }
        ]
      }
    },
    "SubQuery": null,
    "HasTemporary": false,
    "Comment": null
  }
]